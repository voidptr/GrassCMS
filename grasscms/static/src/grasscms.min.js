(function(){var e,d,c,f,b,a;a=function(k,j,g,h){var i;g=$("#"+g);i=Number(($(g)).css(k));if(i==="auto"||!i){i=0}if(j==="-1"){j=i+1}if(j==="+1"){j=i+1}($(g)).css(k,j);if(h){$(g).parent().css(k,j)}return $(g).trigger("changed",k,j)};b=function(g){return $(g).parent().parent()[0].dataset.currentTarget};c=function(g,h){if(h==null){h=False}$(g).trigger("changed","delete");$(g).trigger("clear");if(h){$("#"+g).parent().remove()}return $("#"+g).remove()};f=function(){return $("#"+$("#panel_left")[0].dataset.current_element)};window.getCurrentElement=f;window.delete_=c;window.setCss=a;window.getFromMenu=b;e=(function(){function g(i,h){this.element_=i;this.options=$.extend({},h);this.element=$(this.element_);this.init()}g.prototype.init=function(){this.do_resizable();return this.assign_events()};g.prototype.assign_events=function(){this.element.on("clear",this.clear_all);this.element.on("mouseover",this.mouseover);this.element.on("mouseout",this.mouseout);this.element.on("dragstart",this.dragstart);this.element.on("drag",this.drag);this.element.on("dragend",this.dragend);this.element.on("click",this.element_clicked);this.element.on("changed",this.changed);return this.element.on("contextmenu",this.contextmenu)};g.prototype.element_clicked=function(i){var h,j,k;h=($(i.target)).attr("id");if(!h&&($(($(i.target)).children()[0])).attr("id")){h=($(($(i.target)).children[0])).attr("id")}if(!h){return}$("#panel_left")[0].dataset.current_element=h;if(f().css("opacity")){$("#opacitypicker").val(f().css("opacity"))}else{$("#opacitypicker").val(1)}if($(this).children("img").attr("src")){j=$(this).children("img").attr("src").split("/");k=j[j.length-1]}else{if($(this).children("div")){k="Text element"}}$("#current_element_name").html(k);if(i.shiftKey){return $($(this).children[0]).attr("contentEditable","true")}};g.prototype.clear_all=function(){($("#panel_left")).dataset.current_element=false;return($("#current_element_name")).html("GrassCMS")};g.prototype.mouseover=function(){return($(this)).toggleClass("selectedObject")};g.prototype.contextmenu=function(h){($("#menu"))[0].dataset.currentTarget=$(h.target).attr("id");($("#menu")).css("top",h.y-35);($("#menu")).css("left",h.x-300);($("#menu")).show();return false};g.prototype.mouseout=function(){var h;($(this)).toggleClass("selectedObject");if(($(this)).attr("id")){h=$(this)}else{if(!($(($(this)).children[0])).attr("id")){return}h=$(($(this)).children[0])}if(h.css("height")!==h[0].dataset("height")){h.trigger("changed","height",this.style.height);h.dataset.height=h.css("height")}if(h.css("width")!==h[0].dataset.width){h.trigger("changed","width",this.style.width);return h.dataset.width=h.css("width")}};g.prototype.do_resizable=function(){this.element=this.element.wrap('<div class="resizable">').parent();this.element[0].dataset.width=this.element.css("width");return this.element[0].dataset.height=this.element.css("height")};g.prototype.dragstart=function(h){$(this).trigger("click");this.dataset.opacity=this.style.opacity;return this.style.opacity=0.4};g.prototype.drag=function(h){$(this).attr("draggable","true");this.style.opacity=$(this).data.opacity>0?$(this).dataset.opacity:1;if(h.x>250){this.style.left=h.x-250+"px"}this.style.top=h.y+"px";return this.style.position="absolute"};g.prototype.dragend=function(h){this.style.opacity=this.dataset.opacity>0?this.dataset.opacity:1;$(this).trigger("changed","top",h.y);return $(this).trigger("changed","left",h.x)};g.prototype.changed=function(i,h){var j;return;j=$(this).attr("id");return $.ajax("/object/",{type:"PUT",dataType:"json",data:JSON.stringify({id:j,attr:i,result:h})})};return g})();(function(g){return g.fn.PersistentGrass=function(h){var i;if(h==null){h={offset:250}}return i=new e(this,h)}})($);d=(function(){function g(i,h){this.element=i;($(this.element)).attr("draggable","true");this.element[0].dataset.movement=h;($(this.element)).on("dragstart",this.dragstart);($(this.element)).on("drag",this.drag);($(this.element)).on("dragend",this.dragend)}g.prototype.dragstart=function(i){var h;if(this.dataset.clone!=="true"){this.dataset.clone="true";h=($(this)).clone().appendTo("body");h[0].dataset.clone="false";($(h)).css("z-index",0);($(this)).css("z-index",1);return($(h)).Ruler(this.dataset.movement)}};g.prototype.drag=function(h){if(this.dataset.movement==="x"){if(h.x>250){return this.style.left=h.x+"px"}}else{return this.style.top=h.y+"px"}};g.prototype.dragend=function(h){return this.style.opacity=1};return g})();(function(g){return g.fn.Ruler=function(h){var i;if(h==null){h="y"}return i=new d(this,h)}})($);($(document)).ready(function(){($(document)).on("click",function(g){if(g.button===0&&g.target.parentNode.id!=="#menu"){return $("#menu").css("display","none")}});($("#opacitypicker")).on("change",function(){if(f()){return f().css("opacity",$("#opacitypicker").val())}});($("#colorpicker")).on("change",function(){if($("#panel_left").data("current_element")){return f().css("background",$("#colorpicker").val())}else{return $("body").css("background",$("#colorpicker").val())}});($(".persistentGrassy")).PersistentGrass();($(".rect-x")).Ruler("x");return($(".rect-y")).Ruler("y")})}).call(this);